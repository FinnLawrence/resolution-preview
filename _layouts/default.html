<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
        <title>{{ page.title }}</title>
        <meta name="description" content="{{ page.description }}">
        {% include imports.html %}
        <script>
            function backgroundLoaded(id) {
                var url = "url('" + document.getElementById(id).src + "')";
                var parent = document.getElementById(id).parentNode;
                parent.style.backgroundImage = url;
                parent.style.opacity = "1";
            }
            
            function setScale() {
                
                var windowWidth = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
                var windowHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
                
                var aspect = windowWidth / windowHeight;
                
                console.log(aspect);
                
                var devicesElement = document.getElementById('devices');
                
                if (aspect > 1.3) {
                    // Page is landscape
                    devicesElement.className = "landscape";
                    var imacWidth = .{{ site.landscape-imac-width }};
                    var iphoneWidth =.{{ site.landscape-iphone-width }};
                } else {
                    // Page is portrait (default)
                    devicesElement.className = "";
                    var imacWidth = .{{ site.portrait-imac-width }};
                    var iphoneWidth =.{{ site.portrait-iphone-width }};
                }
                
                console.log("iPhone width: " + iphoneWidth);
                
                var scaleWidth = {{ site.scale-width }};
                var scale = windowWidth / scaleWidth;
                
                var scaleModifier = imacWidth * 0.895;
                
                var scaleModifierRetina = iphoneWidth * 5.419;
            
                console.log("Scale modifier: " + scaleModifierRetina);
            
                var style = document.createElement('style');
                // style.setAttribute("media", "screen")
                // style.setAttribute("media", "only screen and (max-width : 1024px)")
                // WebKit hack :(
                style.appendChild(document.createTextNode(""));
                
                // Add the <style> element to the page
                document.head.appendChild(style);
                var sheet = style.sheet;
                sheet.insertRule(".device iframe { transform: scale(" + (scale * scaleModifier) + ")}", 0);
                sheet.insertRule(".device.retina iframe { transform: scale(" + (scale * scaleModifierRetina) + ")}", 0);
            }
        </script>
    </head>

    <body>
        <header>
            <nav>
                <div class="nav-wrapper">
                    <form id="searchbar" class="left">
                        <div class="input-field">
                            <input id="search" type="search" required value="{{ site.search-url }}">
                            <label for="search"><i class="material-icons">search</i></label>
                            <i class="material-icons">close</i>
                        </div>
                    </form>
                </div>
            </nav>
        </header>
        <main>
            {{ content }}
        </main>
        {% include scripts.html %}
    </body>

</html>
